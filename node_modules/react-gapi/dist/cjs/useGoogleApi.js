"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useGoogleApi = void 0;
var react_1 = require("react");
var GoogleApiContext_1 = require("./GoogleApiContext");
function useGoogleApi(options) {
    var _a, _b;
    if (options === void 0) { options = {}; }
    var _c = (_a = (0, react_1.useContext)(GoogleApiContext_1.GoogleApiContext)) !== null && _a !== void 0 ? _a : {}, gapi = _c.gapi, configure = _c.configure;
    var _d = (0, react_1.useState)(), configureState = _d[0], setConfigureState = _d[1];
    var mounted = (0, react_1.useRef)(true);
    (0, react_1.useEffect)(function () {
        mounted.current = true;
        return function () { mounted.current = false; };
    });
    var _e = (0, react_1.useState)(), rerender = _e[1];
    var auth = (_b = gapi === null || gapi === void 0 ? void 0 : gapi.auth2) === null || _b === void 0 ? void 0 : _b.getAuthInstance();
    (0, react_1.useEffect)(function () {
        if (auth) {
            auth.isSignedIn.listen(function () { return mounted.current && rerender({}); });
            auth.currentUser.listen(function () { return mounted.current && rerender({}); });
        }
    }, [auth]);
    return configure
        ? configure(options, function (newState) { return mounted.current && newState !== configureState && setConfigureState(newState); })
        : undefined;
}
exports.useGoogleApi = useGoogleApi;
//# sourceMappingURL=useGoogleApi.js.map